{% extends "base.html" %}
{% block content %}
{% load static%}

{# Load page-specific CSS #}
{% block page_css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/crud_dashboard.css' %}">
{% endblock %}

<div class="crud-dashboard container">

  <h1 class="dashboard-title">Mango Farmer Dashboard</h1>

  <!-- THREATS -->
  <section class="crud-section">
    <div class="section-header">
      <h2>Threats</h2>
      <a href="{% url 'threat_create' %}" class="btn btn-success">Add New Threat</a>
    </div>
    <table class="table crud-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for threat in recent_threats %}
        <tr>
          <td>{{ threat.name }}</td>
          <td>{{ threat.threat_type }}</td>
          <td>
            <a href="{% url 'threat_update' threat.slug %}" class="btn btn-sm btn-warning">Edit</a>
            <a href="{% url 'threat_delete' threat.slug %}" class="btn btn-sm btn-danger">Delete</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <!-- LOCATIONS -->
  <section class="crud-section">
    <div class="section-header">
      <h2>Locations</h2>
      <a href="{% url 'location_create' %}" class="btn btn-success">Add New Location</a>
    </div>
    <table class="table crud-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for loc in recent_locations %}
        <tr>
          <td>{{ loc.name }}</td>
          <td>
            <a href="{% url 'location_update' loc.pk %}" class="btn btn-sm btn-warning">Edit</a>
            <a href="{% url 'location_delete' loc.pk %}" class="btn btn-sm btn-danger">Delete</a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <!-- TREES -->
  <section class="crud-section">
    <div class="section-header">
      <h2>Mango Trees</h2>
      <a href="{% url 'tree_create' %}" class="btn btn-success">Add New Tree</a>
    </div>
    <table class="table table-striped crud-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Location</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for tree in recent_trees %}
        <tr>
          <td>{{ tree.id }}</td>
          <td>{{ tree.location.name }}</td>
          <td>
            <a href="{% url 'tree_update' tree.id %}" class="btn btn-sm btn-warning">Edit</a>
            <a href="{% url 'tree_delete' tree.id %}" class="btn btn-sm btn-danger">Delete</a>
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="3">No trees found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <!-- STATS -->
  <section class="crud-section stats-section">
    <h2>Statistics</h2>
    <ul class="stats-list">
      <li><strong>Total Threats:</strong> {{ stats.total_threats }}</li>
      <li><strong>Total Pests:</strong> {{ stats.total_pests }}</li>
      <li><strong>Total Diseases:</strong> {{ stats.total_diseases }}</li>
      <li><strong>Total Locations:</strong> {{ stats.total_locations }}</li>
      <li><strong>Total Trees:</strong> {{ stats.total_trees }}</li>
    </ul>
  </section>

</div>
{% endblock %}
